# id: 42
# https://demo.kestra.io/ui/blueprints/community/42
# http://localhost:8080/ui/blueprints/42
# Transform data from CSV files with Pandas in Python containers (in parallel)
# Tags python parallel
description: |
  This flow reads a list of CSV files and processes each file in parallel in isolated Python scripts using Pandas.

id: 42_pythonCsvEachParallel
namespace: blueprint

tasks:
  - id: csv
    type: io.kestra.core.tasks.flows.EachParallel
    value:
      - https://raw.githubusercontent.com/kestra-io/dbt_duckdb/duckdb/seeds/raw_customers.csv
      - https://raw.githubusercontent.com/kestra-io/dbt_duckdb/duckdb/seeds/raw_orders.csv
      - https://raw.githubusercontent.com/kestra-io/dbt_duckdb/duckdb/seeds/raw_payments.csv
    tasks:
      - id: pandas
        type: io.kestra.plugin.scripts.python.Script
        warningOnStdErr: false
        docker:
          image: ghcr.io/kestra-io/pydata:latest
        script: |
          import pandas as pd
          df = pd.read_csv("{{taskrun.value}}")
          df.info()
