id: git_python
namespace: company.team
description: |
  This flow clones a git repository and runs a python ETL script.
  The python tasks will install the required packages before running the script.

tasks:
  - id: python_scripts
    type: io.kestra.plugin.core.flow.WorkingDirectory
    tasks:
      - id: clone_repository
        type: io.kestra.plugin.git.Clone
        description: password is only required for private repositories
        url: https://github.com/kestra-io/examples
        branch: main

      - id: python_etl
        type: io.kestra.plugin.scripts.python.Commands
        beforeCommands:
          - pip install requests pandas
        commands:
          - ./bin/python examples/scripts/etl_script.py
